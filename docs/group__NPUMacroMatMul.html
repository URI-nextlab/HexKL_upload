<!-- HTML header for doxygen 1.14.0-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HexKL: Matrix Multiplication Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">HexKL<span id="projectnumber">&#160;1.0 beta 1</span>
   </div>
   <div id="projectbrief">HexKL Public C API Documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group__NPUMacroMatMul.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Matrix Multiplication Functions <div class="ingroups"><a class="el" href="group__HexKLNPUMacro.html">HexKL NPU Macro API</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Defines functions for performing matrix multiplication using the HMX unit.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaa74aabebb2b569007292739b5edd35ea" id="r_gaa74aabebb2b569007292739b5edd35ea"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaa74aabebb2b569007292739b5edd35ea">hexkl_macro_mm_f16</a> (int n_row, int n_col, int n_inner, _Float16 *restrict A, const _Float16 *restrict X, const _Float16 *restrict W)</td></tr>
<tr class="memdesc:gaa74aabebb2b569007292739b5edd35ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs matrix multiplication of FP16 activations by FP16 weights, producing FP16 results. It avoids data layout and type conversion overhead, assuming the caller provides inputs in the expected formats:  <br /></td></tr>
<tr class="memitem:gaecdb1bbfdd2fc0ef741359e5246a30f4" id="r_gaecdb1bbfdd2fc0ef741359e5246a30f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gaecdb1bbfdd2fc0ef741359e5246a30f4">hexkl_macro_mm_u8i8_i32</a> (int n_row, int n_col, int n_inner, int32_t *restrict A, const uint8_t *restrict X, const int8_t *restrict W)</td></tr>
<tr class="memdesc:gaecdb1bbfdd2fc0ef741359e5246a30f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs matrix multiplication of ui8 activations by i8 weights, producing i32 results. It avoids data layout and type conversion overhead, assuming the caller provides inputs in the expected formats:  <br /></td></tr>
<tr class="memitem:gae78d79e221339e668d8cef06a5c67e40" id="r_gae78d79e221339e668d8cef06a5c67e40"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gae78d79e221339e668d8cef06a5c67e40">hexkl_macro_mm_u8i4_i32</a> (int n_row, int n_col, int n_inner, int32_t *restrict A, const uint8_t *restrict X, const int8_t *restrict W)</td></tr>
<tr class="memdesc:gae78d79e221339e668d8cef06a5c67e40"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs matrix multiplication of ui8 activations by i4 weights, producing i32 results. It avoids data layout and type conversion overhead, assuming the caller provides inputs in the expected formats:  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>Defines functions for performing matrix multiplication using the HMX unit. </p>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="gaa74aabebb2b569007292739b5edd35ea" name="gaa74aabebb2b569007292739b5edd35ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa74aabebb2b569007292739b5edd35ea">&#9670;&#160;</a></span>hexkl_macro_mm_f16()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hexkl_macro_mm_f16 </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_inner</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">_Float16 *restrict</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _Float16 *restrict</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const _Float16 *restrict</td>          <td class="paramname"><span class="paramname"><em>W</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs matrix multiplication of FP16 activations by FP16 weights, producing FP16 results. It avoids data layout and type conversion overhead, assuming the caller provides inputs in the expected formats: </p>
<ul>
<li><span class="tt">A</span>: output matrix, type FP16, layout AH (activation layout for HexKL)</li>
<li><span class="tt">X</span>: input matrix, type FP16, layout AH (activation layout for HexKL)</li>
<li><span class="tt">W</span>: weight matrix, type FP16, layout WH (weight layout for HexKL)</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_row</td><td>Number of rows in matrix X and A. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_col</td><td>Number of columns in matrix W and A. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_inner</td><td>Shared dimension between X and W (columns of X, rows of W). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A</td><td>Pointer to the output matrix A (FP16, AH layout). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">X</td><td>Pointer to the input matrix X (FP16, AH layout). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td>Pointer to the weight matrix W (FP16, WH layout).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><span class="tt">AEE_SUCCESS</span> on successful execution.</li>
<li>Error codes defined in <span class="tt">AEEStdErr.h</span> (e.g., <span class="tt">AEE_EFAILED</span>, <span class="tt">AEE_EBADPARM</span>, etc.) in case of failure.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is the ideal kernel for FP16 matmul on Hexagon NPU, assuming the caller handles layout and type preparation. </dd></dl>

</div>
</div>
<a id="gae78d79e221339e668d8cef06a5c67e40" name="gae78d79e221339e668d8cef06a5c67e40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae78d79e221339e668d8cef06a5c67e40">&#9670;&#160;</a></span>hexkl_macro_mm_u8i4_i32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hexkl_macro_mm_u8i4_i32 </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_inner</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *restrict</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *restrict</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *restrict</td>          <td class="paramname"><span class="paramname"><em>W</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs matrix multiplication of ui8 activations by i4 weights, producing i32 results. It avoids data layout and type conversion overhead, assuming the caller provides inputs in the expected formats: </p>
<ul>
<li><span class="tt">A</span>: output matrix, type INT32</li>
<li><span class="tt">X</span>: input matrix, type UINT8 in row major format</li>
<li><span class="tt">W</span>: weight matrix, type INT8 (packed i4 values) in WH format</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_row</td><td>Number of rows in matrix X and A. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_col</td><td>Number of columns in matrix W and A. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_inner</td><td>Shared dimension between X and W (columns of X, rows of W). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A</td><td>Pointer to the output matrix A (INT32). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">X</td><td>Pointer to the input matrix X (UINT8). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td>Pointer to the weight matrix W (INT8, containing packed i4 values).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><span class="tt">AEE_SUCCESS</span> on successful execution.</li>
<li>Error codes defined in <span class="tt">AEEStdErr.h</span> (e.g., <span class="tt">AEE_EFAILED</span>, <span class="tt">AEE_EBADPARM</span>, etc.) in case of failure.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is the ideal kernel for A8W4I32 matmul on Hexagon NPU, assuming the caller handles layout and type preparation. The i4 weights are packed into i8 containers, with two i4 values per i8 byte. </dd></dl>

</div>
</div>
<a id="gaecdb1bbfdd2fc0ef741359e5246a30f4" name="gaecdb1bbfdd2fc0ef741359e5246a30f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaecdb1bbfdd2fc0ef741359e5246a30f4">&#9670;&#160;</a></span>hexkl_macro_mm_u8i8_i32()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hexkl_macro_mm_u8i8_i32 </td>
          <td>(</td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_row</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_col</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int</td>          <td class="paramname"><span class="paramname"><em>n_inner</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t *restrict</td>          <td class="paramname"><span class="paramname"><em>A</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint8_t *restrict</td>          <td class="paramname"><span class="paramname"><em>X</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int8_t *restrict</td>          <td class="paramname"><span class="paramname"><em>W</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Performs matrix multiplication of ui8 activations by i8 weights, producing i32 results. It avoids data layout and type conversion overhead, assuming the caller provides inputs in the expected formats: </p>
<ul>
<li><span class="tt">A</span>: output matrix, type INT32</li>
<li><span class="tt">X</span>: input matrix, type UINT8</li>
<li><span class="tt">W</span>: weight matrix, type INT8</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n_row</td><td>Number of rows in matrix X and A. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_col</td><td>Number of columns in matrix W and A. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n_inner</td><td>Shared dimension between X and W (columns of X, rows of W). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">A</td><td>Pointer to the output matrix A (INT32). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">X</td><td>Pointer to the input matrix X (UINT8). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">W</td><td>Pointer to the weight matrix W (INT8).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li><span class="tt">AEE_SUCCESS</span> on successful execution.</li>
<li>Error codes defined in <span class="tt">AEEStdErr.h</span> (e.g., <span class="tt">AEE_EFAILED</span>, <span class="tt">AEE_EBADPARM</span>, etc.) in case of failure.</li>
</ul>
</dd></dl>
<dl class="section note"><dt>Note</dt><dd>This is the ideal kernel for A8W8I32 matmul on Hexagon NPU, assuming the caller handles layout and type preparation. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- HTML footer for doxygen 1.14.0-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright (c) Qualcomm Technologies, Inc. and/or its subsidiaries.</li>
  </ul>
</div>
</body>
</html>
